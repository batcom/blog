<!DOCTYPE HTML>
<html>
    <head>
        <!-- SyntaxHighlighter -->
        <script src="../../../public/sh/scripts/shCore.js"></script>
        <script src="../../../public/sh/scripts/shBrushAll.js"></script>
        <link type="text/css" rel="stylesheet" href="../../../public/sh/styles/shCore.css"/>
        <link type="text/css" rel="stylesheet" href="../../../public/sh/styles/shThemeMidnight.css"/>
        <script>
                SyntaxHighlighter.config.clipboardSwf = '../../../public/sh/scripts/clipboard.swf';
                    SyntaxHighlighter.all();
        </script>
                <!-- 第一行是引入核心文件 -->
                <!-- 第二行是引入语法高亮文件（可视需要书写多条，具体可查看 scripts 文件夹下的各个文件） -->
                <!-- 更多语法高亮请访问 https://github.com/ruchee/backup2/tree/master/scripts 获取 -->
                <!-- 第三行是引入基本 CSS 文件 -->
                <!-- 第四行是指定使用的颜色主题（更多主题可查看 styles 文件夹） -->
                <!-- ../../ 指代的是 HTML 代码根目录 -->
        <title>Iptables的配置与安装</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="Stylesheet" type="text/css" href="../../../public/css/main.css" />
        <!-- blog ico -->
        <link type="image/x-icon" rel="icon" href="../../../public/images/ruchee.ico" />
        <link type="image/x-icon" rel="shortcut icon" href="../../../public/images/ruchee.ico" />
    </head>
    <body>
        <center style="font-family: 'Microsoft Yahei', sans-serif; font-size: 1.80em;
            font-weight: normal; color: #FF6600">Mdaxue-Wiki</center><br />
        <center>MdaxueWiki系统</center>


        
<h2 id="toc_0.1">Iptables的配置与安装</h2>
<p>
<code>iptable</code>是<code>Linux</code>下面内置的<code>防火墙</code>，稳定可靠。我们这里也不会详细介绍<code>iptables</code>的所有指令，或者很高深的网络知识，如用<code>iptable</code>做<code>路由器</code>、<code>代理上网</code>，<code>端口转发</code>等,我们只会简单的讲解防火墙最基本的功能，如<code>封ip</code>，<code>只允许指定ip访问指定端口</code>等。
<hr />
</p>
<h3 id="toc_0.1.1">iptables的配置文件</h3>
<p>
iptables配置文件在<code>/etc/sysconfig/iptables</code>:
</p>
<pre>
    # Firewall configuration written by system-config-firewall
    # # Manual customization of this file is not recommended.
     *filter
     :INPUT ACCEPT [0:0]
     :FORWARD ACCEPT [0:0]
     :OUTPUT ACCEPT [0:0]
     -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
     -A INPUT -p icmp -j ACCEPT
     -A INPUT -i lo -j ACCEPT
     -A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
     -A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT
     -A INPUT -m state --state NEW -m tcp -p tcp --dport 10045:10090 -j ACCEPT
     -A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT
     -A INPUT -s 192.168.1.0/24 -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT
     -A INPUT -j REJECT --reject-with icmp-host-prohibited
     -A FORWARD -j REJECT --reject-with icmp-host-prohibited
     COMMIT
    
</pre>
<p>
我们看到的配置文件基本上是这样的。我们只需要记住上面的两种格式，一个是如<code>22</code>号端口的，代表公网开启22号端口，二个是<code>3306</code>的那个，即代表指定ip段开启，我们一般是内网监听。生产上面也只需要记住这两种模式。
<hr />
</p>
<h3 id="toc_0.1.2">防火墙的重启</h3>
<p>
修改了防火墙规则，即上述配置文件后需要重启防火墙才能生效。执行<code>service iptables restart</code>即可。关于如何通过iptables防护Nginx等web服务器的安全现在还暂时不需要，如果后续需要会介绍相关解决方案。
</p>



        <center  style="font-family: 'Microsoft Yahei'; font-size: small; font-weight: normal; color: #009933">
            Mdaxue&nbsp;&copy;&nbsp;2011-2013&nbsp;www.mdaxue.com<br/>
            Generated by Vim and Vimwiki
        </center>
    </body>
</html>
