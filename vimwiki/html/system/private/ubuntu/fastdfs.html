<!DOCTYPE HTML>
<html>
    <head>
        <!-- SyntaxHighlighter -->
        <script src="../../../../public/sh/scripts/shCore.js"></script>
        <script src="../../../../public/sh/scripts/shBrushAll.js"></script>
        <link type="text/css" rel="stylesheet" href="../../../../public/sh/styles/shCore.css"/>
        <link type="text/css" rel="stylesheet" href="../../../../public/sh/styles/shThemeMidnight.css"/>
        <script>
                SyntaxHighlighter.config.clipboardSwf = '../../../../public/sh/scripts/clipboard.swf';
                    SyntaxHighlighter.all();
        </script>
                <!-- 第一行是引入核心文件 -->
                <!-- 第二行是引入语法高亮文件（可视需要书写多条，具体可查看 scripts 文件夹下的各个文件） -->
                <!-- 更多语法高亮请访问 https://github.com/ruchee/backup2/tree/master/scripts 获取 -->
                <!-- 第三行是引入基本 CSS 文件 -->
                <!-- 第四行是指定使用的颜色主题（更多主题可查看 styles 文件夹） -->
                <!-- ../../../ 指代的是 HTML 代码根目录 -->
        <title>FastDfs的安装与配置</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="Stylesheet" type="text/css" href="../../../../public/css/main.css" />
        <!-- blog ico -->
        <link type="image/x-icon" rel="icon" href="../../../../public/images/ruchee.ico" />
        <link type="image/x-icon" rel="shortcut icon" href="../../../../public/images/ruchee.ico" />
    </head>
    <body>
        <center style="font-family: 'Microsoft Yahei', sans-serif; font-size: 1.80em;
            font-weight: normal; color: #FF6600">Mdaxue-Wiki</center><br />
        <center>MdaxueWiki系统</center>


        
<h2 id="toc_0.1">FastDfs的安装与配置</h2>
<p>
这个安装完全可以参考，<a href="../../server/fastdfs.html">FastDfs的安装与配置</a>,这里有详细的说明，而且建议即便是在Ubuntu平台下面安装也先参考一下这里的原理。
<hr />
</p>
<h3 id="toc_0.1.1">需要注意的不同点</h3>
<p>
我们这里只将与上文中不同的地方，主要有两点：
</p>
<ol>
<li>
编译安装过程中的不同：

<ul>
<li>
首先安装整个过程中所需要的包：sudo apt-get install libevent(这个默认就有，没有就装下) libevent-dev apache2-dev然后需要修改以下文件make.sh 这个根据实际情况来修改 ，因为如果不该默认会报找不到pthread类的错误
<pre class="brush :bash">
    if [ -f /usr/lib/x86_64-linux-gnu/libpthread.so ] || [ -f /usr/local/lib/libpthread.so ] || [ -f /lib64/libpthread.so ] || [ -f /usr/lib64/libpthread.so ] || [ -f /usr/lib/x86_64-linux-gnu/libpthread.a ] || [ -f /usr/local/lib/libpthread.a ] || [ -f /lib64/libpthread.a ] || [ -f /usr/lib64/libpthread.a ]; then

    #32为平台要改为
    if [ -f /usr/lib/i386-linux-gnu/libpthread.so ] || [ -f /usr/local/lib/libpthread.so ] || [ -f /lib64/libpthread.so ] || [ -f /usr/lib64/libpthread.so ] || [ -f /usr/lib/i386-linux-gnu/libpthread.a ] || [ -f /usr/local/lib/libpthread.a ] || [ -f /lib64/libpthread.a ] || [ -f /usr/lib64/libpthread.a ]; then
</pre>

<li>
client/fdfs_link_library.sh.in <code>32</code>位平台也是修改为相应路径:
<pre class="brush :bash">
if [ "`id -u`" = "0" ]; then
  ln -fs $TARGET_LIB/libfastcommon.so.1 /usr/lib/x86_64-linux-gnu/libfastcommon.so
  ln -fs $TARGET_LIB/libfdfsclient.so.1 /usr/lib/x86_64-linux-gnu/libfdfsclient.so

  if [ "$OS_BITS" = "8" ]; then
     ln -fs $TARGET_LIB/libfastcommon.so.1 /usr/lib/x86_64-linux-gnu/libfastcommon.so
     ln -fs $TARGET_LIB/libfdfsclient.so.1 /usr/lib/x86_64-linux-gnu/libfdfsclient.so
  fi
fi
</pre>

<li>
主要就是要保证这两个库能被找到，可以先find，然后修改对应路径即可，修改好了就可以按CentOS平台一样执行:<code>sh make.sh &amp;&amp; sh make.sh install</code>了

</ul>
<li>
服务器为apache

<ul>
<li>
apache-fastdfs模块的安装:
<pre class="brush :bash">
        tar zxf fastdfs-apache-module_v1.15.tar.gz
        cd fastdfs-apache-module/src
        #修改Makefile，我这里APACHE_BASE_PATH=/usr/share/apache2就可以了
        #这里whereis查询相应的可执行文件路径，如果没有，cp一份过去都行，主要是会找不到build下面的special.mk,因为我的apache2是直接apt-get的
        #所以这里需要apt-get install apache2-dev
        #这里处理需要灵活，只要保证能找到文件就可以了
        make &amp;&amp; make install
</pre>

<li>
apache-fastdfs模块的配置:
<pre>
        安装完成后，会在/etc/fdfs下有一个mod_fastdfs.conf
        vim /etc/fdfs/mod_fastdfs.conf
        修改tracker_server = 192.168.1.88 这里为你的ip或者tracker的IP
        修改url_hava_group_name = true
        修改store_path0 = /data/fastdfs/store
        然后就需要apache加载fastdfs模块，即加载.so文件
        vim /etc/apache2/mods-enabled/fastdfs.load
        LoadModule fastdfs_module /usr/lib/apache2/modules/mod_fastdfs.so
        设置apache的文件匹配
        vim /etc/apache2/apache2.conf
        在Include port.conf后面加入
        Include fastdfs.conf
        vim /etc/apache2/fastdfs.conf
        写入
        &lt;Location /group1/M00&gt;
        sethandler fastdfs
        &lt;/Location&gt;
        保存即可。
        重启apache
</pre>

</ul>
</ol>
<hr />



        <center  style="font-family: 'Microsoft Yahei'; font-size: small; font-weight: normal; color: #009933">
            Mdaxue&nbsp;&copy;&nbsp;2011-2013&nbsp;www.mdaxue.com<br/>
            Generated by Vim and Vimwiki
        </center>
    </body>
</html>
